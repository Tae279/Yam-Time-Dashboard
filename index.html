<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Tracking Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --color-primary: #FFD700;
            --color-secondary: #1E3A8A;
            --color-success: #10B981;
            --color-warning: #F59E0B;
            --color-danger: #EF4444;
            --color-bg: #0F172A;
            --color-surface: #1E293B;
            --color-text: #F1F5F9;
            --color-text-secondary: #CBD5E1;
            --color-border: rgba(255, 215, 0, 0.1);
            --color-blue-dark: #1E3A8A;
            --color-yellow-bright: #FFD700;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 30px;
        }

        h1 {
            font-size: 32px;
            margin-bottom: 8px;
            color: var(--color-text);
        }

        .header-subtitle {
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #1E293B 0%, #0F172A 100%);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--color-yellow-bright);
            box-shadow: 0 6px 16px rgba(255, 215, 0, 0.15);
            transform: translateY(-2px);
        }

        .stat-card h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--color-yellow-bright);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .stat-unit {
            font-size: 12px;
            color: var(--color-text-secondary);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: linear-gradient(135deg, #1E293B 0%, #0F172A 100%);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.08);
        }

        .chart-container h2 {
            font-size: 16px;
            margin-bottom: 20px;
            color: var(--color-text);
            font-weight: 600;
        }

        canvas {
            max-height: 300px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .data-table {
            background: linear-gradient(135deg, #1E293B 0%, #0F172A 100%);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.08);
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid var(--color-border);
        }

        .table-header h2 {
            font-size: 16px;
            color: var(--color-text);
            margin: 0;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        thead {
            background: rgba(30, 58, 138, 0.3);
            border-bottom: 1px solid var(--color-border);
        }

        th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--color-yellow-bright);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-size: 11px;
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--color-border);
            color: var(--color-text-secondary);
        }

        tr:hover {
            background: rgba(255, 215, 0, 0.05);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 500;
        }

        .status-ontime {
            background: rgba(16, 185, 129, 0.2);
            color: var(--color-success);
            border: 1px solid var(--color-success);
        }

        .status-late {
            background: rgba(245, 158, 11, 0.2);
            color: var(--color-warning);
            border: 1px solid var(--color-warning);
        }

        .status-toolate {
            background: rgba(239, 68, 68, 0.2);
            color: var(--color-danger);
            border: 1px solid var(--color-danger);
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Executive Summary Dashboard -->
        <div style="background: linear-gradient(135deg, #1E293B 0%, #0F172A 100%); border-radius: 20px; border: 1px solid rgba(255, 215, 0, 0.1); padding: 40px; margin-bottom: 40px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);">
            <h2 style="font-size: 36px; background: linear-gradient(135deg, #FFD700, #FBBF24); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-align: center; margin-bottom: 10px;">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2568</h2>
            <p style="text-align: center; color: #CBD5E1; font-size: 18px; margin-bottom: 40px;">DX0044 - ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å‡∏î‡∏µ‡πÑ‡∏ã‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î | 01/01/68 - 17/12/68</p>
            
            <div class="exec-grid" id="execStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px;">
                <!-- Stats will be populated by JavaScript -->
            </div>
            
            <div style="background: rgba(255, 215, 0, 0.1); border-radius: 16px; padding: 24px; border-left: 4px solid #FFD700;">
                <h3 style="color: #FFD700; margin-bottom: 12px;">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3>
                <p id="execSummary" style="color: #CBD5E1; line-height: 1.6;"></p>
            </div>
        </div>

        <header>
            <h1 style="color: #FFD700; text-align: center;">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h1>
            <p class="header-subtitle" style="text-align: center;">DX0044 - ‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å‡∏î‡∏µ‡πÑ‡∏ã‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î</p>
        </header>

        <div class="dashboard-grid">
            <div class="stat-card">
                <h3>‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div class="stat-value" id="workingDays">0</div>
                <div class="stat-unit">‡∏ß‡∏±‡∏ô</div>
            </div>
            <div class="stat-card">
                <h3>‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                <div class="stat-value" id="avgLate">0</div>
                <div class="stat-unit">‡∏ô‡∏≤‡∏ó‡∏µ</div>
            </div>
            <div class="stat-card">
                <h3>‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                <div class="stat-value" id="avgExit">0</div>
                <div class="stat-unit">‡∏ô‡∏≤‡∏ó‡∏µ</div>
            </div>
            <div class="stat-card">
                <h3>‡∏ß‡∏±‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤</h3>
                <div class="stat-value" id="onTimeDays">0</div>
                <div class="stat-unit">‡∏ß‡∏±‡∏ô</div>
            </div>
        </div>

        <!-- Analytics Summary -->
        <div style="background: linear-gradient(145deg, #1E293B, #334155); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: 16px; padding: 24px; margin-bottom: 24px;">
            <h2 style="font-size: 18px; color: #F1F5F9; margin-bottom: 16px;">üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü</h2>
            <div id="chartAnalytics"></div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <h2>‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)</h2>
                <canvas id="entranceChart"></canvas>
            </div>
            <div class="chart-container">
                <h2>üö™ ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)</h2>
                <canvas id="exitChart"></canvas>
            </div>
            <div class="chart-container">
                <h2>üìä ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤</h2>
                <canvas id="lateChart"></canvas>
            </div>
            <div class="chart-container">
                <h2>üìâ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏•‡πÄ‡∏ß‡∏•‡∏≤</h2>
                <canvas id="deviationChart"></canvas>
            </div>
        </div>

        <div class="data-table">
            <div class="table-header">
                <h2>üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤</th>
                        <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡∏Å</th>
                        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Data extracted from PDF
        const timeData = [
            { date: '03/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '08/01/68', entrance: '12:00', entranceActual: '12:27', exit: '21:00', exitActual: '21:12' },
            { date: '10/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '13/01/68', entrance: '12:00', entranceActual: '12:05', exit: '21:00', exitActual: '21:34' },
            { date: '14/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '15/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '16/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '17/01/68', entrance: '12:00', entranceActual: '12:33', exit: '21:00', exitActual: '21:16' },
            { date: '20/01/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '23/01/68', entrance: '12:00', entranceActual: '12:19', exit: '21:00', exitActual: '21:21' },
            { date: '24/01/68', entrance: '12:00', entranceActual: '12:33', exit: '21:00', exitActual: '21:46' },
            { date: '29/01/68', entrance: '12:00', entranceActual: '12:03', exit: '21:00', exitActual: '21:05' },
            { date: '30/01/68', entrance: '12:00', entranceActual: '12:16', exit: '21:00', exitActual: '21:15' },
            { date: '31/01/68', entrance: '12:00', entranceActual: '12:26', exit: '21:00', exitActual: '21:14' },
            { date: '03/02/68', entrance: '12:00', entranceActual: '12:05', exit: '21:00', exitActual: '21:17' },
            { date: '05/02/68', entrance: '12:00', entranceActual: '12:18', exit: '21:00', exitActual: '21:58' },
            { date: '07/02/68', entrance: '12:00', entranceActual: '12:14', exit: '21:00', exitActual: '21:38' },
            { date: '10/02/68', entrance: '12:00', entranceActual: '12:04', exit: '21:00', exitActual: '21:14' },
            { date: '13/02/68', entrance: '12:00', entranceActual: '12:30', exit: '21:00', exitActual: '21:34' },
            { date: '14/02/68', entrance: '12:00', entranceActual: '12:05', exit: '21:00', exitActual: '21:14' },
            { date: '19/02/68', entrance: '12:00', entranceActual: '12:01', exit: '21:00', exitActual: '21:46' },
            { date: '24/02/68', entrance: '12:00', entranceActual: '12:29', exit: '21:00', exitActual: '21:26' },
            { date: '26/02/68', entrance: '12:00', entranceActual: '12:38', exit: '21:00', exitActual: '21:18' },
            { date: '27/02/68', entrance: '12:00', entranceActual: '12:16', exit: '21:00', exitActual: '21:45' },
            { date: '28/02/68', entrance: '12:00', entranceActual: '12:04', exit: '21:00', exitActual: '21:39' },
            { date: '07/03/68', entrance: '12:00', entranceActual: '12:05', exit: '21:00', exitActual: '21:00' },
            { date: '11/03/68', entrance: '12:00', entranceActual: '16:59', exit: '21:00', exitActual: '21:18' },
            { date: '12/03/68', entrance: '12:00', entranceActual: '12:13', exit: '21:00', exitActual: '21:34' },
            { date: '13/03/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '14/03/68', entrance: '12:00', entranceActual: '12:46', exit: '21:00', exitActual: '21:27' },
            { date: '18/03/68', entrance: '12:00', entranceActual: '12:06', exit: '21:00', exitActual: '21:27' },
            { date: '25/03/68', entrance: '12:00', entranceActual: '12:02', exit: '21:00', exitActual: '21:16' },
            { date: '27/03/68', entrance: '12:00', entranceActual: '12:03', exit: '21:00', exitActual: '21:32' },
            { date: '02/04/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '03/04/68', entrance: '12:00', entranceActual: '12:23', exit: '21:00', exitActual: '22:07' },
            { date: '04/04/68', entrance: '12:00', entranceActual: '12:26', exit: '21:00', exitActual: '21:13' },
            { date: '08/04/68', entrance: '12:00', entranceActual: '12:02', exit: '21:00', exitActual: '22:17' },
            { date: '17/04/68', entrance: '12:00', entranceActual: '11:51', exit: '18:26', exitActual: '18:26' },
            { date: '18/04/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '25/04/68', entrance: '12:00', entranceActual: '12:03', exit: '21:00', exitActual: '21:01' },
            { date: '02/05/68', entrance: '12:00', entranceActual: '12:04', exit: '21:00', exitActual: '21:00' },
            { date: '05/05/68', entrance: '12:00', entranceActual: '12:50', exit: '21:00', exitActual: '21:53' },
            { date: '06/05/68', entrance: '12:00', entranceActual: '12:23', exit: '21:00', exitActual: '21:17' },
            { date: '07/05/68', entrance: '12:00', entranceActual: '12:36', exit: '21:00', exitActual: '21:36' },
            { date: '08/05/68', entrance: '12:00', entranceActual: '17:02', exit: '21:00', exitActual: '21:08' },
            { date: '12/05/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '14/05/68', entrance: '12:00', entranceActual: '12:40', exit: '21:00', exitActual: '21:19' },
            { date: '19/05/68', entrance: '12:00', entranceActual: '12:22', exit: '21:00', exitActual: '21:14' },
            { date: '27/05/68', entrance: '12:00', entranceActual: '12:22', exit: '21:00', exitActual: '21:05' },
            { date: '28/05/68', entrance: '12:00', entranceActual: '12:20', exit: '21:00', exitActual: '21:12' },
            { date: '29/05/68', entrance: '12:00', entranceActual: '12:32', exit: '21:00', exitActual: '21:04' },
            { date: '30/05/68', entrance: '12:00', entranceActual: '12:36', exit: '21:00', exitActual: '21:07' },
            { date: '03/06/68', entrance: '12:00', entranceActual: '12:53', exit: '21:00', exitActual: '21:16' },
            { date: '04/06/68', entrance: '12:00', entranceActual: '12:05', exit: '21:00', exitActual: '21:28' },
            { date: '05/06/68', entrance: '12:00', entranceActual: '16:56', exit: '21:00', exitActual: '21:30' },
            { date: '18/06/68', entrance: '12:00', entranceActual: '16:53', exit: '21:00', exitActual: '21:07' },
            { date: '24/06/68', entrance: '12:00', entranceActual: '12:01', exit: '21:00', exitActual: '21:16' },
            { date: '26/06/68', entrance: '12:00', entranceActual: '12:11', exit: '21:00', exitActual: '21:08' },
            { date: '30/06/68', entrance: '12:00', entranceActual: '12:44', exit: '21:00', exitActual: '21:12' },
            { date: '01/07/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '03/07/68', entrance: '12:00', entranceActual: '12:53', exit: '21:00', exitActual: '21:39' },
            { date: '08/07/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '09/07/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '10/07/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '11/07/68', entrance: '12:00', entranceActual: '12:00', exit: '16:00', exitActual: '16:00' },
            { date: '17/07/68', entrance: '12:00', entranceActual: '12:51', exit: '21:00', exitActual: '21:07' },
            { date: '24/07/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '25/07/68', entrance: '12:00', entranceActual: '12:06', exit: '21:00', exitActual: '21:14' },
            { date: '29/07/68', entrance: '12:00', entranceActual: '12:15', exit: '21:00', exitActual: '21:31' },
            { date: '31/07/68', entrance: '12:00', entranceActual: '12:44', exit: '21:00', exitActual: '21:31' },
            { date: '06/08/68', entrance: '12:00', entranceActual: '12:36', exit: '21:00', exitActual: '21:30' },
            { date: '13/08/68', entrance: '12:00', entranceActual: '12:11', exit: '21:00', exitActual: '21:10' },
            { date: '15/08/68', entrance: '12:00', entranceActual: '12:09', exit: '21:00', exitActual: '21:04' },
            { date: '20/08/68', entrance: '12:00', entranceActual: '12:20', exit: '21:00', exitActual: '21:00' },
            { date: '26/08/68', entrance: '12:00', entranceActual: '12:23', exit: '21:00', exitActual: '21:06' },
            { date: '27/08/68', entrance: '12:00', entranceActual: '12:08', exit: '21:00', exitActual: '21:15' },
            { date: '02/09/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '03/09/68', entrance: '12:00', entranceActual: '12:40', exit: '21:00', exitActual: '21:08' },
            { date: '04/09/68', entrance: '12:00', entranceActual: '12:06', exit: '21:00', exitActual: '22:05' },
            { date: '08/09/68', entrance: '12:00', entranceActual: '12:13', exit: '21:00', exitActual: '21:10' },
            { date: '10/09/68', entrance: '12:00', entranceActual: '16:51', exit: '21:00', exitActual: '21:07' },
            { date: '15/09/68', entrance: '12:00', entranceActual: '12:22', exit: '21:00', exitActual: '21:05' },
            { date: '18/09/68', entrance: '12:00', entranceActual: '11:55', exit: '21:00', exitActual: '21:00' },
            { date: '19/09/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '25/09/68', entrance: '12:00', entranceActual: '12:17', exit: '21:00', exitActual: '21:07' },
            { date: '26/09/68', entrance: '12:00', entranceActual: '12:00', exit: '21:00', exitActual: '21:00' },
            { date: '30/09/68', entrance: '12:00', entranceActual: '13:07', exit: '21:00', exitActual: '21:29' },
            { date: '01/10/68', entrance: '12:00', entranceActual: '12:30', exit: '21:00', exitActual: '21:06' },
            { date: '02/10/68', entrance: '12:00', entranceActual: '12:02', exit: '21:00', exitActual: '21:09' },
            { date: '03/10/68', entrance: '12:00', entranceActual: '12:10', exit: '21:00', exitActual: '21:04' },
            { date: '06/10/68', entrance: '12:00', entranceActual: '12:21', exit: '21:00', exitActual: '21:27' },
            { date: '07/10/68', entrance: '12:00', entranceActual: '12:34', exit: '21:00', exitActual: '21:31' },
            { date: '08/10/68', entrance: '12:00', entranceActual: '13:04', exit: '21:00', exitActual: '21:00' },
            { date: '09/10/68', entrance: '12:00', entranceActual: '12:34', exit: '21:00', exitActual: '21:12' },
            { date: '14/10/68', entrance: '12:00', entranceActual: '12:06', exit: '21:00', exitActual: '21:07' },
            { date: '15/10/68', entrance: '12:00', entranceActual: '12:08', exit: '21:00', exitActual: '21:05' },
            { date: '16/10/68', entrance: '12:00', entranceActual: '12:56', exit: '21:00', exitActual: '21:11' },
            { date: '22/10/68', entrance: '12:00', entranceActual: '12:41', exit: '21:00', exitActual: '21:06' },
            { date: '23/10/68', entrance: '12:00', entranceActual: '12:01', exit: '21:00', exitActual: '21:01' },
            { date: '27/10/68', entrance: '12:00', entranceActual: '12:07', exit: '21:00', exitActual: '21:02' },
            { date: '03/11/68', entrance: '12:00', entranceActual: '12:20', exit: '21:00', exitActual: '21:16' },
            { date: '10/11/68', entrance: '12:00', entranceActual: '12:27', exit: '21:00', exitActual: '21:19' },
            { date: '17/11/68', entrance: '12:00', entranceActual: '12:02', exit: '21:00', exitActual: '21:05' },
            { date: '18/11/68', entrance: '12:00', entranceActual: '12:17', exit: '21:00', exitActual: '21:04' },
            { date: '25/11/68', entrance: '12:00', entranceActual: '12:01', exit: '21:00', exitActual: '22:21' },
            { date: '27/11/68', entrance: '12:00', entranceActual: '12:07', exit: '21:00', exitActual: '21:13' },
            { date: '28/11/68', entrance: '12:00', entranceActual: '12:58', exit: '21:00', exitActual: '21:07' },
            { date: '01/12/68', entrance: '12:00', entranceActual: '12:07', exit: '21:00', exitActual: '21:17' },
            { date: '09/12/68', entrance: '12:00', entranceActual: '12:03', exit: '21:00', exitActual: '21:01' },
            { date: '11/12/68', entrance: '12:00', entranceActual: '12:58', exit: '21:00', exitActual: '21:12' },
            { date: '15/12/68', entrance: '12:00', entranceActual: '12:15', exit: '21:00', exitActual: '21:24' },
            { date: '16/12/68', entrance: '12:00', entranceActual: '12:20', exit: '21:00', exitActual: '21:16' }
        ];

        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function getDeviation(scheduled, actual) {
            return timeToMinutes(actual) - timeToMinutes(scheduled);
        }

        function formatTime(minutes) {
            const sign = minutes < 0 ? '-' : '';
            const absMin = Math.abs(minutes);
            const h = Math.floor(absMin / 60);
            const m = absMin % 60;
            return `${sign}${h}h ${m}m`;
        }

        function getStatus(deviation) {
            if (deviation <= 0) return 'ontime';
            if (deviation <= 30) return 'late';
            return 'toolate';
        }

        // Calculate statistics
        function calculateStats() {
            let totalLateEntrance = 0;
            let totalEarlyExit = 0;
            let onTimeCount = 0;

            timeData.forEach(record => {
                const entranceDeviation = getDeviation(record.entrance, record.entranceActual);
                const exitDeviation = getDeviation(record.exit, record.exitActual);

                if (entranceDeviation > 0) totalLateEntrance += entranceDeviation;
                if (exitDeviation < 0) totalEarlyExit += Math.abs(exitDeviation);
                if (entranceDeviation <= 0) onTimeCount++;
            });

            const avgLate = Math.round(totalLateEntrance / timeData.length);
            const avgExit = Math.round(totalEarlyExit / timeData.length);

            document.getElementById('workingDays').textContent = timeData.length;
            document.getElementById('avgLate').textContent = avgLate;
            document.getElementById('avgExit').textContent = avgExit;
            document.getElementById('onTimeDays').textContent = onTimeCount;
        }

        // Charts
        function createEntranceChart() {
            const ctx = document.getElementById('entranceChart').getContext('2d');
            const labels = timeData.map(d => d.date);
            const deviations = timeData.map(d => getDeviation(d.entrance, d.entranceActual));
            const colors = deviations.map(d => d <= 0 ? '#208090' : d <= 30 ? '#A84B2F' : '#C0152F');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Late/Early (minutes)',
                        data: deviations,
                        backgroundColor: colors,
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'x',
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#FFD700',
                            bodyColor: '#F1F5F9',
                            borderColor: '#FFD700',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return formatTime(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 215, 0, 0.1)' },
                            ticks: { font: { size: 11 }, color: '#CBD5E1' }
                        },
                        x: {
                            ticks: { font: { size: 9 }, color: '#CBD5E1' }
                        }
                    }
                }
            });
        }

        function createExitChart() {
            const ctx = document.getElementById('exitChart').getContext('2d');
            const labels = timeData.map(d => d.date);
            const deviations = timeData.map(d => getDeviation(d.exit, d.exitActual));
            const colors = deviations.map(d => d < 0 ? '#10B981' : '#F59E0B');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Early/Late Exit (minutes)',
                        data: deviations,
                        backgroundColor: colors,
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'x',
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#FFD700',
                            bodyColor: '#F1F5F9',
                            borderColor: '#FFD700',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return formatTime(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 215, 0, 0.1)' },
                            ticks: { font: { size: 11 }, color: '#CBD5E1' }
                        },
                        x: {
                            ticks: { font: { size: 9 }, color: '#CBD5E1' }
                        }
                    }
                }
            });
        }

        function createLateChart() {
            const lateData = timeData.filter(d => getDeviation(d.entrance, d.entranceActual) > 0);
            const lateDeviations = lateData.map(d => getDeviation(d.entrance, d.entranceActual));

            const ctx = document.getElementById('lateChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    datasets: [{
                        label: 'Late Minutes Distribution',
                        data: lateDeviations,
                        backgroundColor: '#F59E0B',
                        borderColor: '#F59E0B',
                        borderWidth: 1,
                        barPercentage: 0.8
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#FFD700',
                            bodyColor: '#F1F5F9',
                            borderColor: '#FFD700',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return 'Late: ' + context.parsed.x + ' min';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255, 215, 0, 0.1)' },
                            title: { display: true, text: 'Minutes Late', color: '#CBD5E1' },
                            ticks: { font: { size: 10 }, color: '#CBD5E1' }
                        },
                        y: {
                            grid: { display: false },
                            title: { display: true, text: 'Frequency', color: '#CBD5E1' },
                            ticks: { font: { size: 10 }, color: '#CBD5E1' }
                        }
                    }
                }
            });
        }

        function createDeviationChart() {
            const ctx = document.getElementById('deviationChart').getContext('2d');
            const labels = timeData.map(d => d.date);
            const entranceDeviations = timeData.map(d => getDeviation(d.entrance, d.entranceActual));
            const exitDeviations = timeData.map(d => getDeviation(d.exit, d.exitActual));

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Entrance Deviation',
                            data: entranceDeviations,
                            borderColor: '#F59E0B',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.3,
                            fill: false,
                            pointRadius: 3,
                            pointBackgroundColor: '#F59E0B',
                            borderWidth: 2
                        },
                        {
                            label: 'Exit Deviation',
                            data: exitDeviations,
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3,
                            fill: false,
                            pointRadius: 3,
                            pointBackgroundColor: '#10B981',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { font: { size: 11 }, usePointStyle: true, color: '#CBD5E1' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#FFD700',
                            bodyColor: '#F1F5F9',
                            borderColor: '#FFD700',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatTime(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 215, 0, 0.1)' },
                            ticks: { font: { size: 10 }, color: '#CBD5E1' }
                        },
                        x: {
                            grid: { color: 'rgba(255, 215, 0, 0.05)' },
                            ticks: { font: { size: 8 }, color: '#CBD5E1' }
                        }
                    }
                }
            });
        }

        // Populate table
        function populateTable() {
            const tbody = document.getElementById('tableBody');
            timeData.forEach(record => {
                const entranceDev = getDeviation(record.entrance, record.entranceActual);
                const exitDev = getDeviation(record.exit, record.exitActual);
                const entranceStatus = getStatus(entranceDev);
                const exitStatus = getStatus(exitDev);

                const row = `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.entranceActual}</td>
                        <td>${record.exitActual}</td>
                        <td><span class="status-badge status-${entranceStatus}">${formatTime(entranceDev)}</span></td>
                        <td><span class="status-badge status-${exitStatus}">${formatTime(exitDev)}</span></td>
                        <td>${entranceDev <= 0 ? '‚úì On time' : '‚ö† Late'}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Create Executive Summary Cards
        function createExecSummary() {
            const stats = {
                totalDays: timeData.length,
                onTimeDays: 0,
                lateDays: 0,
                totalLateMin: 0,
                totalEarlyExit: 0,
                avgLateness: 0,
                maxLateness: 0
            };

            timeData.forEach(record => {
                const entranceDev = getDeviation(record.entrance, record.entranceActual);
                const exitDev = getDeviation(record.exit, record.exitActual);

                if (entranceDev <= 0) stats.onTimeDays++;
                if (entranceDev > 0) {
                    stats.lateDays++;
                    stats.totalLateMin += entranceDev;
                    stats.maxLateness = Math.max(stats.maxLateness, entranceDev);
                }
                if (exitDev < 0) stats.totalEarlyExit += Math.abs(exitDev);
            });

            stats.avgLateness = Math.round(stats.totalLateMin / stats.lateDays);
            const onTimePercent = Math.round((stats.onTimeDays / stats.totalDays) * 100);

            // Create exec cards
            const execGrid = document.getElementById('execStats');
            const cards = [
                { label: '‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', value: stats.totalDays, unit: '‡∏ß‡∏±‡∏ô' },
                { label: '‡∏ß‡∏±‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤', value: stats.onTimeDays, unit: `‡∏ß‡∏±‡∏ô (${onTimePercent}%)` },
                { label: '‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤', value: stats.lateDays, unit: '‡∏ß‡∏±‡∏ô' },
                { label: '‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢', value: stats.avgLateness, unit: '‡∏ô‡∏≤‡∏ó‡∏µ' },
                { label: '‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î', value: stats.maxLateness, unit: '‡∏ô‡∏≤‡∏ó‡∏µ' }
            ];

            execGrid.innerHTML = cards.map(card => `
                <div style="background: linear-gradient(145deg, #1E293B, #334155); border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 20px; padding: 30px 20px; text-align: center; position: relative; overflow: hidden; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 20px 40px rgba(255, 215, 0, 0.2)'; this.style.borderColor='#FFD700';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow=''; this.style.borderColor='rgba(255, 215, 0, 0.2)';">
                    <div style="font-size: 12px; color: #CBD5E1; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;">${card.label}</div>
                    <div style="font-size: 40px; font-weight: 700; background: linear-gradient(135deg, #FFD700, #FBBF24); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 8px;">${card.value}</div>
                    <div style="font-size: 13px; color: #CBD5E1;">${card.unit}</div>
                </div>
            `).join('');

            // Create summary text
            const summaryText = `
                üìä <strong>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û:</strong> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ${onTimePercent}% (${stats.onTimeDays}/${stats.totalDays} ‡∏ß‡∏±‡∏ô)<br>
                ‚ö†Ô∏è <strong>‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤:</strong> ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${stats.avgLateness} ‡∏ô‡∏≤‡∏ó‡∏µ, ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${stats.maxLateness} ‡∏ô‡∏≤‡∏ó‡∏µ<br>
                ‚úÖ <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠:</strong> ‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏°‡∏µ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)<br>
                üéØ <strong>‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</strong> ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡πâ‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î
            `;
            document.getElementById('execSummary').innerHTML = summaryText;
        }

        // Create Chart Analytics
        function createChartAnalytics() {
            const entranceData = timeData.map(d => getDeviation(d.entrance, d.entranceActual));
            const exitData = timeData.map(d => getDeviation(d.exit, d.exitActual));
            const lateCount = entranceData.filter(d => d > 0).length;

            const avgEntrance = Math.round(entranceData.reduce((a, b) => a + b, 0) / entranceData.length);
            const avgExit = Math.round(exitData.reduce((a, b) => a + b, 0) / exitData.length);
            const maxLate = Math.max(...entranceData);
            const earlyExitCount = exitData.filter(d => d < 0).length;

            const analyticsDiv = document.getElementById('chartAnalytics');
            analyticsDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                    <div style="background: rgba(30, 58, 138, 0.2); padding: 16px; border-radius: 12px; border-left: 4px solid #F59E0B;">
                        <strong style="color: #FFD700;">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</strong><br>
                        <span style="color: #CBD5E1; font-size: 14px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${Math.abs(avgEntrance)} ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤ ${lateCount} ‡∏ß‡∏±‡∏ô ‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${maxLate} ‡∏ô‡∏≤‡∏ó‡∏µ</span>
                    </div>
                    <div style="background: rgba(30, 58, 138, 0.2); padding: 16px; border-radius: 12px; border-left: 4px solid #10B981;">
                        <strong style="color: #FFD700;">üö™ ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô</strong><br>
                        <span style="color: #CBD5E1; font-size: 14px;">‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ${Math.abs(avgExit)} ‡∏ô‡∏≤‡∏ó‡∏µ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡∏°‡∏µ ${earlyExitCount} ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</span>
                    </div>
                    <div style="background: rgba(30, 58, 138, 0.2); padding: 16px; border-radius: 12px; border-left: 4px solid #F59E0B;">
                        <strong style="color: #FFD700;">üìä ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤</strong><br>
                        <span style="color: #CBD5E1; font-size: 14px;">‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤ ${lateCount} ‡∏ß‡∏±‡∏ô (${Math.round((lateCount/timeData.length)*100)}%) ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤ 1-50 ‡∏ô‡∏≤‡∏ó‡∏µ</span>
                    </div>
                    <div style="background: rgba(30, 58, 138, 0.2); padding: 16px; border-radius: 12px; border-left: 4px solid #FFD700;">
                        <strong style="color: #FFD700;">üìâ ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</strong><br>
                        <span style="color: #CBD5E1; font-size: 14px;">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ô ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</span>
                    </div>
                </div>
            `;
        }

        // Initialize dashboard
        window.addEventListener('load', () => {
            createExecSummary();
            createChartAnalytics();
            calculateStats();
            createEntranceChart();
            createExitChart();
            createLateChart();
            createDeviationChart();
            populateTable();
        });
    </script>
</body>
</html>
